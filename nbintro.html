<!DOCTYPE html>
<html>

<head>
    <title>笔记本简介</title>
    <meta charset="utf-8" />
    <style>
        #main {
            font-size: 1.3rem;
            line-height: 2.3rem;
            width: 96vw;
        }
        
        span {
            font-weight: 600;
        }
    </style>
</head>

<body>
    <div id="main">
        <span>
            笔记本工作原理以及加密方法简介
        </span>
        <p>
            <span>
                预备知识:
            </span>
        </p>
        <p>
            8个比特(bit, 二进制) = 1个字节(byte); 2位16进制 = 8个比特; 16进制数由0-9 a-f表示 (a表示11 ... f表示15)
        </p>
        <p>
            暴力破解: 即，利用穷举法(穷尽所有可能组合实现破解)破解。 例: 银行卡密码有6位数字，如果使用暴力破解 破解银行卡密码 需要先尝试 000001然后000002, 000003 ... 000009, 000010... 直到 999999。
        </p>
        <p>
            前端代码: 运行在你浏览器中的代码。
        </p>
        <p>
            1秒 = 1000毫秒。
        </p>
        <p>
            数字摘要: 产生数字摘要的过程是一种数学运算过程，简称函数，这个函数可以把一段内容，比如"abc"(不包含双引号，以下同理) 经过运算后得到一串长度固定的数据，比如abc的运算结果是
            <p>
                ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad
            </p>
            这个运算结果是由16进制表示的，以供人类阅读，一共有64位16进制，根据上面的知识可以得出， 一共有32个字节，共256 bits数据，
            这也就是本站采用的数字摘要算法: SHA256。 数字摘要也称散列函数、哈希函数，由这个函数产生的结果叫做数字摘要或散列值或哈希值。

            <p>
                产生的数字摘要不可以使用逆运算得到原始值，即，你无法通过
                <p>ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad</p> 运算得到
                <p>abc</p>
            </p>
            <p>
                运算结果不是随机的，你通过
                <p>abc</p> 运算得到的结果总是
                <p>ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad</p>
            </p>

            <p>
                函数的运算过程是严谨的，例，abc在计算机中以二进制存储， 其二进制为 0110 0001 0110 0010 0110 0011 ， 即使只改动其中一个二进制位，也会让输出的数字摘要产生巨大的差异。
            </p>

            两个不同的内容使用SHA256生成的数字摘要完全相同的概率极小，具体数据请自行搜索"sha256碰撞概率"。

            <p>
                下文中将此函数记为f。数字摘要以下简称hash。
            </p>
        </p>
        <p>
            高级加密标准（Advanced Encryption Standard，AES）: AES是一种加密算法的名称，本站使用了AES-128-CBC加密算法。 简单来说AES可以把一个数据 A 通过 一个 密匙 B 和一个初始化向量 C 运算得到结果 D 。 AES的运算结果是可逆的，即，你通过相同的 密匙 B 相同的初始化向量 C 可以把 D 还原为 A。 AES被认为是目前世界上最安全的加密算法之一，AES-128-CBC加密算法从理论上来说不可能实现技术性破解，只能采用暴力破解。 但如果暴力破解一个被AES-128-CBC加密算法加密过的结果，如果使用地球上所有的计算机算力(包括超级计算机)破解一个AES-128-CBC加密后的结果，大概需要10亿年。
        </p>

        <span>
            以下进入正题
        </span>

        <p>
            当你注册时，首先前端代码会检查你的用户名是否符合规则和密码是否可靠，然后对你的用户名和密码执行f，
             得到用户名的hashA和密码的hashB，然后将hashB的前16个字节再执行一次f，得到结果hashC， 将hashB的后16个字节再执行一次f，得到hashD。
        </p>
        <p>
            为了简便记忆，令a = hashA, b = hashB, c = hashC, d = hashD。
        </p>
        <p>
            a是你的登录过程的用户名凭证;
        </p>
        <p>
            c是你的登录过程的密匙凭证的一部分;
        </p>
        <p>
            d是你的笔记加密密匙的一部分;
        </p>
        <p>
            然后浏览器与服务器采用DH算法(自行搜索DH算法)协商出一个密码e，使用e对c进行加密处理得到h，然后将a和h和邀请码一同发送给服务器。
        </p>
        <p>
            然后服务器通过e对h进行解密，得到c，将a和c存储，作为你的登录凭证。
        </p>
        <p>
            当你每次登录时，前端代码会获取一个UNIX时间戳z，这是一个很大的数字，这个数字是从1970年1月1日 00:00:00 到现在的毫秒数(以下简称时间戳)。
        </p>
        <p>
            然后执行 m = f(c+z); 步骤A，c与z是成对的。
        </p>
        <p>
            然后将a、z、m一起发给服务器。步骤B
        </p>
        <p>
            服务器会从之前你注册时保存的登录凭证中找到相同的a，如果找不到，证明此用户不存在。如果找到了，服务器会读取出存储的a的c，记为p;
        </p>

        <p>
            服务器也执行 j = f(p+z);
        </p>

        <p>
            如果登录人输入了正确的密码，即，p与b完全相同，那么
        </p>
        <p>
            因为z是相同的，所以 m = j; 此时，用户登陆成功。
        </p>

        <p>
            每一对b和z只能使用一次，即，即使有人截获了你的登录信息他也无法再次凭信息登录。
        </p>

        <p>
            如果有人在步骤B先一步截获了你的a z m 然后断开你与服务器的连接，然后他将a z m 发给服务器，服务器也会认为他是合法的用户。 
            所以，如果你发现当你点击登录后，没有成功登录(如果你确保你使用了正确的用户名和密码)，那么你的账户可能正在被攻击。 此攻击可能出现的情况包括但不限于:
        </p>

        <p>
            1. 你使用了公共的AP(Access Point，热点，俗称WIFI)上网，此AP提前被黑客布置了攻击代码。
        </p>

        <p>
            2. 你使用了不安全的设备，手机、电脑、平板电脑等，此设备提前被布置了攻击代码。
        </p>

        <p>
            3. 你使用了不安全的浏览器，此浏览器被提前布置了攻击代码。
        </p>

        <p>
            以上是较为常用的攻击手段，防范措施包括但不限于:

        </p>
        <p>
            使用受信任的WIFI热点, 或尽量不使用商场的WIFI热点
        </p>

        <p>
            使用自己的设备
        </p>
        <p>
            使用Google Chrome或Apple Safari或最新版的Edge浏览器, 且保证你的浏览器<span>没有安装不安全的插件</span> 。
        </p>
        <p>
            除此以外，DNS劫持也是一种常见的攻击手段，请使用大公司提供的DNS服务器，但是这不能保证一定能够防范此攻击手段。 另外，使用
            <span>最新版的</span> Google Chrome或Apple Safari浏览器可以有效避免被攻击。
        </p>
        <p>
            DNS劫持知识补充: 网站的服务器拥有一个ip地址，类似于192.168.2.1，但此名称不便于记忆，每次你上网时，当你输入www.baidu.com， 你的设备会自动询问DNS服务器这个域名(www.baidu.com)所指向的ip地址，然后你才能访问。 例如 www.baidu.com 指向ip 192.168.2.1，但DNS劫持会将 www.baidu.com 指向 192.168.98.100 ，此ip上可能被黑客架设了同样的服务器， 你所看到的网站页面会和真正的 www.baidu.com
            一样，以此来骗取你的各种信息。
        </p>
        <p>
            当你成功登录账户时，前端代码会自动向服务器请求你的笔记数据，假设现在这个账户时一个新的账户，没有任何笔记数据。
        </p>
        <p>
            当你新建第一条笔记时，你的笔记内容会经过如下加密过程(t是这条笔记的时间戳):
        </p>
        <p>
            令k = f(d+t), v = f(a+t+d)
        </p>
        <p>
            以k作为这条笔记的密匙，以v作为这条笔记的初始化向量，对这条笔记执行加密，记为加密后的密文记为r，然后将r传输给服务器进行保存。
        </p>
        <p>
            当你成功登录账户时，服务器会把你存储在服务器上的笔记内容发送给浏览器，浏览器为每条笔记创建k和v，然后用每条笔记的k和v解密每条笔记。
        </p>
    </div>
</body>

</html>
