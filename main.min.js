(e=>{let t=window;t.config={bit:16,level:0};t.bitGroup=[];t.levelGroup=[];t.app=[];let n=!1,l={en:"Copied!",zh:"\u590d\u5236\u6210\u529f!"},o={en:"Custom",zh:"\u6dfb\u52a0\u9009\u9879"},r={en:"Add",zh:"\u6dfb\u52a0"},a={en:["Show","Hide"],zh:["\u663e\u793a","\u9690\u85cf"]},s={en:["Store","Delete"],zh:["\u5b58\u50a8","\u5220\u9664"]},i=localStorage,c={en:'This action will store your password in "localStorage" in your browser, DO NOT store password in public device. This action is NOT recommended.',zh:'\u5bc6\u7801\u4f1a\u4fdd\u5b58\u5728\u4f60\u6d4f\u89c8\u5668\u7684"LocalStorage"\u4e2d, \u4e0d\u8981\u5728\u516c\u5171\u8bbe\u5907\u4e0a\u5b58\u50a8\u5bc6\u7801\u3002\u4e0d\u5efa\u8bae\u4f7f\u7528\u8fd9\u4e2a\u64cd\u4f5c\u3002'},p={en:"MAIN PASSWORD",zh:"\u4e3b\u5bc6\u7801"},u={en:"Click to copy",zh:"\u70b9\u51fb\u590d\u5236"},h={en:"Length",zh:"\u4f4d\u6570"},d=navigator.language;d=/zh/i.test(d);(e=>{let n,l,o,r=(e,t)=>t>>>e|t<<32-e,a=(e,t,n)=>e&t^~e&n,s=(e,t,n)=>e&t^e&n^t&n,i=e=>r(2,e)^r(13,e)^r(22,e),c=e=>r(6,e)^r(11,e)^r(25,e),p=e=>r(7,e)^r(18,e)^e>>>3,u=e=>r(17,e)^r(19,e)^e>>>10,h=(e,t)=>e[15&t]+=u(e[t+14&15])+e[t+9&15]+p(e[t+1&15]),d=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),f="0123456789abcdef",g=(e,t)=>{let n=(65535&e)+(65535&t),l=(e>>16)+(t>>16)+(n>>16);return l<<16|65535&n},w=()=>{n=new Array(8);l=new Array(2);o=new Array(64);l[0]=l[1]=0;n[0]=1779033703;n[1]=3144134277;n[2]=1013904242;n[3]=2773480762;n[4]=1359893119;n[5]=2600822924;n[6]=528734635;n[7]=1541459225},v=()=>{let e,t,l,r,p,u,f,w,v,b,m=new Array(16);e=n[0];t=n[1];l=n[2];r=n[3];p=n[4];u=n[5];f=n[6];w=n[7];for(let e=0;e<16;e++)m[e]=o[3+(e<<2)]|o[2+(e<<2)]<<8|o[1+(e<<2)]<<16|o[e<<2]<<24;for(let n=0;n<64;n++){v=w+c(p)+a(p,u,f)+d[n];v+=n<16?m[n]:h(m,n);b=i(e)+s(e,t,l);w=f;f=u;u=p;p=g(r,v);r=l;l=t;t=e;e=g(v,b)}n[0]+=e;n[1]+=t;n[2]+=l;n[3]+=r;n[4]+=p;n[5]+=u;n[6]+=f;n[7]+=w},b=(e,t)=>{let n,r,a=0;r=l[0]>>3&63;let s=63&t;(l[0]+=t<<3)<t<<3&&l[1]++;l[1]+=t>>29;for(n=0;n+63<t;n+=64){for(let t=r;t<64;t++)o[t]=e.charCodeAt(a++);v();r=0}for(let t=0;t<s;t++)o[t]=e.charCodeAt(a++)},m=()=>{let e=l[0]>>3&63;o[e++]=128;if(e<=56)for(let t=e;t<56;t++)o[t]=0;else{for(let t=e;t<64;t++)o[t]=0;v();for(let e=0;e<56;e++)o[e]=0}o[56]=l[1]>>>24&255;o[57]=l[1]>>>16&255;o[58]=l[1]>>>8&255;o[59]=255&l[1];o[60]=l[0]>>>24&255;o[61]=l[0]>>>16&255;o[62]=l[0]>>>8&255;o[63]=255&l[0];v()},x=()=>{let e=0,t=new Array(32);for(let l=0;l<8;l++){t[e++]=n[l]>>>24&255;t[e++]=n[l]>>>16&255;t[e++]=n[l]>>>8&255;t[e++]=255&n[l]}return t},y=()=>{let e=new String;for(let t=0;t<8;t++)for(let l=28;l>=0;l-=4)e+=f.charAt(n[t]>>>l&15);return e},z=(e,t)=>{w();b(e,e.length);m();return t?x():y()},S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",A="+=-_,.!@#%",T=(e,t)=>{let n="";if(1==t)for(let t of e)n+=-1==S.indexOf(t)&&-1==A.indexOf(t)?(S+A).substr(t.charCodeAt()%(S.length+A.length),1):t;else if(2==t)for(let t of e)n+=-1==S.indexOf(t)?S.substr(t.charCodeAt()%S.length,1):t;else n=e;return n},C=(e,t,n)=>{let l="",o="";for(;t-- >0;){let t=z(""!=o?o:e,!0);o="";for(let e of t)o+=String.fromCharCode(33+e%93);o=T(o,n);l+=o}return l};t.getPassword=((e,t,n)=>{let l=1,o=C(e,parseInt(n/32)+l++,t),r=!1,a=/[0-9]/,s=/[A-Z]/,i=/[a-z]/,c=/[\+=\-,\.!@#%]/,p=/[`~\$\^&\*\(\)\[\]\{\};:'"<>\?\/\\|]/,u=0,h="",d=(e,t)=>{let n=!0;for(let l of t){n=l.test(e);if(!n)break}return n},f=e=>{let t="";for(let n of e)a.test(n)&&(t+=n);return t};for(;!r;){if(-1!=t){h=o.substr(u,n);r=d(h,0==t?[a,s,i,p]:1==t?[a,s,i,c]:[a,s,i])}else{h+=f(o);r=n<h.length}o=-1!=t?o.length-u++<=n?C(e,parseInt(n/32)+l++,t):o:C(e+h,parseInt(n/32)+l++,t)}return-1==t?h.substr(0,n):h})})();let f=e=>{let n=get("mainPass"),l="";for(let e of t.app)l+=e.value;if(n.value&&l){let e=getPassword(n.value+l,t.config.level,t.config.bit);get("password").value=e}};t.get=function(e){return document.getElementById(e)};let g=e=>{e=e||"div";return document.createElement(e)};t.showMsg=((e,t)=>{let n=get("msgBox");n.innerHTML=e;n.className="msgBox";n.onclick=(e=>{n.className="msgBox msgBoxHide"});t&&setTimeout(()=>{n.onclick()},t)});t.custom=(e=>{let t=get("custom-bit").value;if(!t)return;t=parseInt(t);if(!t)return;let n=localStorage;n.custom||(n.custom="[]");let l=JSON.parse(n.custom),o=l.find(e=>e.bit==t);if(!o){l.push({bit:t});new w({type:"bit",value:t,text:t.toString(),container:b});n.custom=JSON.stringify(l)}});class w{constructor(t){let n=this;t=t||{};n.type=t.type||"level";n.value=t.value;n.selected=0;"bit"==t.type?bitGroup.push(n):levelGroup.push(n);let l=g();l.className="config";let o=g("span");o.innerText=t.text;let r=g();n.dot=r;r.className="dot";l.appendChild(r);l.appendChild(o);l.onclick=(e=>{n.select.apply(n,[e])});t.selected&&n.select.apply(n,[e]);t.container.appendChild(l)}select(){let e=this,n="bit"==e.type?bitGroup:levelGroup;for(let e of n)e.unselect();e.selected=1;e.dot.className="dot dot-selected";"bit"==e.type?t.config.bit=e.value:t.config.level=e.value;f()}unselect(){let e=this;e.selected=0;e.dot.className="dot"}}class v{constructor(e){this.input=g("input");let n=this.input;this.value="";n.type="text";n.className="app";n.placeholder="App";n.onkeyup=(e=>{this.keyup.apply(this,[e])});this.container=e;e.appendChild(n);t.app.push(this)}keyup(e){this.value=this.input.value;f();if(this.value)""!=t.app[t.app.length-1].value&&new v(get("app"));else if(t.app.length>1){t.app.splice(t.app.findIndex(e=>e==this),1);this.value="";this.container.removeChild(this.input)}}}let b=get("div-bits"),m=get("div-level"),x=get("mainPass"),y=get("custom-bit"),z=get("password");y.placeholder=d?h.zh:h.en;x.placeholder=d?p.zh:p.en;z.placeholder=d?u.zh:u.en;z.onclick=function(e){navigator.clipboard.writeText(this.value).then(e=>{showMsg(d?l.zh:l.en,1e3)})};get("btnShowCustom").innerText=d?o.zh:o.en;get("btnAddCustom").innerText=d?r.zh:r.en;x.onkeyup=(e=>{f()});let S=get("btnShowPwd"),A=get("btnStore");S.innerText=d?a.zh[0]:a.en[0];if(i.password&&i.password.length){x.value=i.password;A.innerText=d?s.zh[1]:s.en[1]}else A.innerText=d?s.zh[0]:s.en[0];get("showM").onclick=function(e){if(n){n=0;x.type="password";S.innerText=d?a.zh[0]:a.en[0]}else{n=!0;x.type="text";S.innerText=d?a.zh[1]:a.en[1]}};get("store").onclick=function(e){if(A.innerText==(d?s.zh[0]:s.en[0])){i.password=x.value;showMsg(d?c.zh:c.en);A.innerText=d?s.zh[1]:s.en[1]}else{i.password="";A.innerText=d?s.zh[0]:s.en[0]}};localStorage.password&&(x.value=localStorage.password);new w({type:"bit",value:256,text:"256",container:b});new w({type:"bit",value:16,text:"16",selected:1,container:b});new w({type:"bit",value:8,text:"8",container:b});new w({type:"bit",value:6,text:"6",container:b});if(localStorage.custom){let t=0;try{t=JSON.parse(localStorage.custom)}catch(e){}if(t)for(let e of t)new w({type:"bit",custom:!0,value:e.bit,text:e.bit.toString(),container:b})}new w({value:0,text:"A",selected:1,container:m});new w({value:1,text:"B",container:m});new w({value:2,text:"C",container:m});new w({value:-1,text:"D",container:m});new v(get("app"))})();
